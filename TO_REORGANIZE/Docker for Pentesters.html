<!DOCTYPE html>
<html><head>
<meta http-equiv="content-type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<title>Docker for Pentesters</title>
<meta name="description" content="Docker has become such an integral part of my worfklow recently. These examples should demonstrate how Docker can help you be a more efficient pentester">
<meta name="HandheldFriendly" content="True">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<link rel="apple-touch-icon" sizes="57x57" href="https://blog.ropnop.com/assets/img/favicons/apple-touch-icon-57x57.png">
<link rel="apple-touch-icon" sizes="60x60" href="https://blog.ropnop.com/assets/img/favicons/apple-touch-icon-60x60.png">
<link rel="apple-touch-icon" sizes="72x72" href="https://blog.ropnop.com/assets/img/favicons/apple-touch-icon-72x72.png">
<link rel="apple-touch-icon" sizes="76x76" href="https://blog.ropnop.com/assets/img/favicons/apple-touch-icon-76x76.png">
<link rel="apple-touch-icon" sizes="114x114" href="https://blog.ropnop.com/assets/img/favicons/apple-touch-icon-114x114.png">
<link rel="apple-touch-icon" sizes="120x120" href="https://blog.ropnop.com/assets/img/favicons/apple-touch-icon-120x120.png">
<link rel="apple-touch-icon" sizes="144x144" href="https://blog.ropnop.com/assets/img/favicons/apple-touch-icon-144x144.png">
<link rel="apple-touch-icon" sizes="152x152" href="https://blog.ropnop.com/assets/img/favicons/apple-touch-icon-152x152.png">
<link rel="apple-touch-icon" sizes="180x180" href="https://blog.ropnop.com/assets/img/favicons/apple-touch-icon-180x180.png">
<link rel="icon" type="image/png" href="https://blog.ropnop.com/assets/img/favicons/favicon-32x32.png" sizes="32x32">
<link rel="icon" type="image/png" href="https://blog.ropnop.com/assets/img/favicons/android-chrome-192x192.png" sizes="192x192">
<link rel="icon" type="image/png" href="https://blog.ropnop.com/assets/img/favicons/favicon-96x96.png" sizes="96x96">
<link rel="icon" type="image/png" href="https://blog.ropnop.com/assets/img/favicons/favicon-16x16.png" sizes="16x16">
<link rel="manifest" href="https://blog.ropnop.com/assets/img/favicons/manifest.json">
<link rel="mask-icon" href="https://blog.ropnop.com/assets/img/favicons/safari-pinned-tab.svg" color="#5bbad5">
<link rel="shortcut icon" href="https://blog.ropnop.com/assets/img/favicons/favicon.ico">
<meta name="msapplication-TileColor" content="#da532c">
<meta name="msapplication-TileImage" content="/assets/img/favicons/mstile-144x144.png">
<meta name="msapplication-config" content="/assets/img/favicons/browserconfig.xml">
<meta name="theme-color" content="#ffffff">
<link rel="stylesheet" type="text/css" href="Docker%20for%20Pentesters_files/screen.css">
<link rel="stylesheet" type="text/css" href="Docker%20for%20Pentesters_files/custom.css">
<link rel="stylesheet" type="text/css" href="Docker%20for%20Pentesters_files/css.css">
<link rel="stylesheet" href="Docker%20for%20Pentesters_files/font-awesome.css">
<link rel="stylesheet" type="text/css" href="Docker%20for%20Pentesters_files/prism.css">
<link rel="stylesheet" type="text/css" href="Docker%20for%20Pentesters_files/rrssb.css">
<link rel="canonical" href="Docker%20for%20Pentesters_files/a_004.html">
<meta name="referrer" content="origin-when-cross-origin">
<meta property="og:site_name" content="ropnop blog">
<meta property="og:type" content="article">
<meta property="og:title" content="Docker for Pentesters">
<meta property="og:description" content="Docker has become such an integral part of my worfklow recently. These examples should demonstrate how Docker can help you be a more efficient pentester">
<meta property="og:url" content="https://blog.ropnop.com/docker-for-pentesters/">
<meta property="og:image" content="https://blog.ropnop.com/content/images/2019/07/dockershell_tomcat-1.png">
<meta property="article:published_time" content="2019-07-18T02:44:06.000Z">
<meta property="article:modified_time" content="2019-07-18T02:44:06.000Z">
<meta property="article:tag" content="docker">
<meta property="article:tag" content="pentest">
<meta property="article:tag" content="impacket">
<meta property="article:tag" content="linux">
<meta property="article:tag" content="smb">
<meta property="article:tag" content="windows">
<meta name="twitter:card" content="summary_large_image">
<meta name="twitter:title" content="Docker for Pentesters">
<meta name="twitter:description" content="Docker has become such an integral part of my worfklow recently. These examples should demonstrate how Docker can help you be a more efficient pentester">
<meta name="twitter:url" content="https://blog.ropnop.com/docker-for-pentesters/">
<meta name="twitter:image" content="https://blog.ropnop.com/content/images/2019/07/dockershell_tomcat-1.png">
<meta name="twitter:label1" content="Written by">
<meta name="twitter:data1" content="ropnop">
<meta name="twitter:label2" content="Filed under">
<meta name="twitter:data2" content="docker, pentest, impacket, linux, smb, windows">
<meta name="twitter:site" content="@ropnop">
<script async="" src="Docker%20for%20Pentesters_files/analytics.js"></script><script type="application/ld+json">
{
    "@context": "https://schema.org",
    "@type": "Article",
    "publisher": {
        "@type": "Organization",
        "name": "ropnop blog",
        "logo": "https://blog.ropnop.com/content/images/2016/04/Daltrey-tommy-banner.jpg"
    },
    "author": {
        "@type": "Person",
        "name": "ropnop",
        "url": "https://blog.ropnop.com/author/ropnop/",
        "sameAs": []
    },
    "headline": "Docker for Pentesters",
    "url": "https://blog.ropnop.com/docker-for-pentesters/",
    "datePublished": "2019-07-18T02:44:06.000Z",
    "dateModified": "2019-07-18T02:44:06.000Z",
    "image": "https://blog.ropnop.com/content/images/2019/07/dockershell_tomcat-1.png",
    "keywords": "docker, pentest, impacket, linux, smb, windows",
    "description": "Docker has become such an integral part of my worfklow recently. These examples should demonstrate how Docker can help you be a more efficient pentester"
}
    </script>
<meta name="generator" content="Ghost 0.9">
<link rel="alternate" type="application/rss+xml" title="ropnop blog" href="https://blog.ropnop.com/rss/">
<script>
// to enable Google Analytics
var ga_id = 'UA-76398957-1';

// to enable Disqus
var disqus_shortname = 'ropnopblog'


// to enable Social Link Icons add the social_link object
// with the pair key/value -> social_network/link
// NB: the key is used to include the right icon from Font Awesome
// (you can include any Font Awesome icon)

// Example2: squared social network icons
var social_link = {
    'twitter-square': 'https://twitter.com/ropnop',
    'github-square': 'https://github.com/ropnop',
    'rss':'https://blog.ropnop.com/rss/'
    // you can add more icons
}

</script>
<script type="text/javascript" async="" src="Docker%20for%20Pentesters_files/embed.js"></script><style id="fit-vids-style">.fluid-width-video-wrapper{width:100%;position:relative;padding:0;}.fluid-width-video-wrapper iframe,.fluid-width-video-wrapper object,.fluid-width-video-wrapper embed {position:absolute;top:0;left:0;width:100%;height:100%;}</style><link rel="prefetch" as="style" href="Docker%20for%20Pentesters_files/a_data_002/lounge.css"><link rel="prefetch" as="script" href="Docker%20for%20Pentesters_files/a_data_002/common.js"><link rel="prefetch" as="script" href="Docker%20for%20Pentesters_files/a_data_002/lounge.js"><link rel="prefetch" as="script" href="Docker%20for%20Pentesters_files/a_data_002/config.js"></head>
<body class="post-template tag-docker tag-pentest tag-impacket tag-linux tag-smb tag-windows">
<div class="site-wrapper">
<header class="main-header post-head no-cover">
<nav class="main-nav  clearfix">
<a class="back-button icon-arrow-left" href="https://blog.ropnop.com/"> Home</a>
<a class="subscribe-button icon-feed" href="https://blog.ropnop.com/rss/"> Subscribe</a>
</nav>
</header>
<main class="content" role="main">
<article class="post tag-docker tag-pentest tag-impacket tag-linux tag-smb tag-windows">
<header class="post-header">
<h1 class="post-title">Docker for Pentesters</h1>
<section class="post-meta">
<time class="post-date" datetime="2019-07-18">18 July 2019</time> on <a href="https://blog.ropnop.com/tag/docker/">docker</a>, <a href="https://blog.ropnop.com/tag/pentest/">pentest</a>, <a href="https://blog.ropnop.com/tag/impacket/">impacket</a>, <a href="https://blog.ropnop.com/tag/linux/">linux</a>, <a href="https://blog.ropnop.com/tag/smb/">smb</a>, <a href="https://blog.ropnop.com/tag/windows/">windows</a>
</section>
<section class="social-share">
<ul class="rrssb-buttons clearfix rrssb-1 large-format" style="font-size: 19.4167px;">
<li class="rrssb-email" style="width: 33.3333%;" data-initwidth="33.333333333333336" data-size="38">

<a href="mailto:?subject=Docker%20for%20Pentesters&amp;body=Docker%20for%20Pentesters%0A%0Ahttps%3A%2F%2Fblog.ropnop.com%2Fdocker-for-pentesters%2F">
<span class="rrssb-icon">
<svg xmlns="http://www.w3.org/2000/svg" width="28" height="28" viewBox="0 0 28 28">
<path d="M20.11 26.147c-2.335 1.05-4.36 1.4-7.124 1.4C6.524 27.548.84 22.916.84 15.284.84 7.343 6.602.45 15.4.45c6.854 0 11.8 4.7 11.8 11.252 0 5.684-3.193 9.265-7.398 9.3-1.83 0-3.153-.934-3.347-2.997h-.077c-1.208 1.986-2.96 2.997-5.023 2.997-2.532 0-4.36-1.868-4.36-5.062 0-4.75 3.503-9.07 9.11-9.07 1.713 0 3.7.4 4.6.972l-1.17 7.203c-.387 2.298-.115 3.3 1 3.4 1.674 0 3.774-2.102 3.774-6.58 0-5.06-3.27-8.994-9.304-8.994C9.05 2.87 3.83 7.545 3.83 14.97c0 6.5 4.2 10.2 10 10.202 1.987 0 4.09-.43 5.647-1.245l.634 2.22zM16.647 10.1c-.31-.078-.7-.155-1.207-.155-2.572 0-4.596 2.53-4.596 5.53 0 1.5.7 2.4 1.9 2.4 1.44 0 2.96-1.83 3.31-4.088l.592-3.72z"></path>
</svg>
</span>
<span class="rrssb-text">email</span>
</a>
</li>
<li class="rrssb-twitter" style="width: 33.3333%;" data-initwidth="33.333333333333336" data-size="55">

<a href="https://twitter.com/intent/tweet?text=Docker%20for%20Pentesters%20https%3A%2F%2Fblog.ropnop.com%2Fdocker-for-pentesters%2F" class="popup">
<span class="rrssb-icon">
<svg xmlns="http://www.w3.org/2000/svg" width="28" height="28" viewBox="0 0 28 28">
<path d="M24.253 8.756C24.69 17.08 18.297 24.182 9.97 24.62c-3.122.162-6.22-.646-8.86-2.32 2.702.18 5.375-.648 7.507-2.32-2.072-.248-3.818-1.662-4.49-3.64.802.13 1.62.077 2.4-.154-2.482-.466-4.312-2.586-4.412-5.11.688.276 1.426.408 2.168.387-2.135-1.65-2.73-4.62-1.394-6.965C5.574 7.816 9.54 9.84 13.802 10.07c-.842-2.738.694-5.64 3.434-6.48 2.018-.624 4.212.043 5.546 1.682 1.186-.213 2.318-.662 3.33-1.317-.386 1.256-1.248 2.312-2.4 2.942 1.048-.106 2.07-.394 3.02-.85-.458 1.182-1.343 2.15-2.48 2.71z"></path>
</svg>
</span>
<span class="rrssb-text">twitter</span>
</a>
</li>
<li class="rrssb-reddit" style="width: 33.3333%;" data-initwidth="33.333333333333336" data-size="46">
<a href="http://www.reddit.com/submit?url=https%3A%2F%2Fblog.ropnop.com%2Fdocker-for-pentesters%2F&amp;text=Docker%20for%20Pentesters&amp;title=Docker%20for%20Pentesters">
<span class="rrssb-icon">
<svg xmlns="http://www.w3.org/2000/svg" width="28" height="28" viewBox="0 0 28 28">
<path d="M11.794 15.316c0-1.03-.835-1.895-1.866-1.895-1.03 0-1.893.866-1.893 1.896s.863 1.9 1.9 1.9c1.023-.016 1.865-.916 1.865-1.9zM18.1 13.422c-1.03 0-1.895.864-1.895 1.895 0 1 .9 1.9 1.9 1.865 1.03 0 1.87-.836 1.87-1.865-.006-1.017-.875-1.917-1.875-1.895zM17.527 19.79c-.678.68-1.826 1.007-3.514 1.007h-.03c-1.686 0-2.834-.328-3.51-1.005-.264-.265-.693-.265-.958 0-.264.265-.264.7 0 1 .943.9 2.4 1.4 4.5 1.402.005 0 0 0 0 0 .005 0 0 0 0 0 2.066 0 3.527-.46 4.47-1.402.265-.264.265-.693.002-.958-.267-.334-.688-.334-.988-.043z"></path>
<path d="M27.707 13.267c0-1.785-1.453-3.237-3.236-3.237-.792 0-1.517.287-2.08.76-2.04-1.294-4.647-2.068-7.44-2.218l1.484-4.69 4.062.955c.07 1.4 1.3 2.6 2.7 2.555 1.488 0 2.695-1.208 2.695-2.695C25.88 3.2 24.7 2 23.2 2c-1.06 0-1.98.616-2.42 1.508l-4.633-1.09c-.344-.082-.693.117-.803.454l-1.793 5.7C10.55 8.6 7.7 9.4 5.6 10.75c-.594-.45-1.3-.75-2.1-.72-1.785 0-3.237 1.45-3.237 3.2 0 1.1.6 2.1 1.4 2.69-.04.27-.06.55-.06.83 0 2.3 1.3 4.4 3.7 5.9 2.298 1.5 5.3 2.3 8.6 2.325 3.227 0 6.27-.825 8.57-2.325 2.387-1.56 3.7-3.66 3.7-5.917 0-.26-.016-.514-.05-.768.965-.465 1.577-1.565 1.577-2.698zm-4.52-9.912c.74 0 1.3.6 1.3 1.3 0 .738-.6 1.34-1.34 1.34s-1.343-.602-1.343-1.34c.04-.655.596-1.255 1.396-1.3zM1.646 13.3c0-1.038.845-1.882 1.883-1.882.31 0 .6.1.9.21-1.05.867-1.813 1.86-2.26 2.9-.338-.328-.57-.728-.57-1.26zm20.126 8.27c-2.082 1.357-4.863 2.105-7.83 2.105-2.968 0-5.748-.748-7.83-2.105-1.99-1.3-3.087-3-3.087-4.782 0-1.784 1.097-3.484 3.088-4.784 2.08-1.358 4.86-2.106 7.828-2.106 2.967 0 5.7.7 7.8 2.106 1.99 1.3 3.1 3 3.1 4.784C24.86 18.6 23.8 20.3 21.8 21.57zm4.014-6.97c-.432-1.084-1.19-2.095-2.244-2.977.273-.156.59-.245.928-.245 1.036 0 1.9.8 1.9 1.9-.016.522-.27 1.022-.57 1.327z"></path>
</svg>
</span>
<span class="rrssb-text">reddit</span>
</a>
</li>
</ul>
</section>
</header>
<section class="post-content">
<h3 id="tableofcontents">Table of Contents</h3>
<li><a href="#background">Background</a></li> <ul> <li><a href="#usefuldockeraliases">Useful Docker Aliases</a></li> </ul> <li><a href="#example1exploringotheross">Example 1 - Exploring other OSs</a></li> <li><a href="#example2compilingcodeforoldtargets">Example 2 - Compiling Code for old targets</a></li> <li><a href="#example3impacket">Example 3 - Impacket</a></li> <li><a href="#example4smbserverwithimpacket">Example 4 - SMB Server with Impacket</a></li> <li><a href="#example5servinghttpfiles">Example 5 - Serving HTTP Files</a></li> <li><a href="#example6servingfilesoverwebdav">Example 6 - Serving Files over WebDav</a></li> <li><a href="#example6servingfilesbehindnatwithngrok">Example 6 - Serving Files behind NAT with Ngrok</a></li> <li><a href="#example7metasploit">Example 7 - Metasploit</a></li> <li><a href="#example8msfvenom">Example 8 - msfvenom</a></li> <li><a href="#example9capturinghttpfiles">Example 9 - Capturing HTTP Files</a></li> <li><a href="#bonusexamplewindowscontainers">Bonus Example - Windows Containers</a></li> <li><a href="#conclusion">Conclusion</a></li> <li><a href="#tldr">tl;dr</a></li>
<br>
<p>Over the last few years I have done a complete 180 on Docker (well, 
containerization in general). One of the very first posts I wrote on 
this blog was about <a href="https://blog.ropnop.com/plundering-docker-images/">plundering Docker images</a>,
 and at the time I was not a fan. I didn't see the benefit of Docker, I 
thought it was confusing, I thought it was a fad and I couldn't 
understand why anyone thought it was better than just a VM.</p>
<p>Fast forward 3 years and Docker has become an indespensible part of my day-to-day workflow, both professionally and personally.</p>
<p>My hope in this post is to demonstrate some of my usecases and 
workflows, and illustrate how I think pentesters and security 
professionals in general can greatly benefit from Docker.</p>
<h1 id="background">Background</h1>
<p>Everybody has probably seen a diagram like this when Googling "Container vs VM" (in fact, this one is the top result)</p>
<p><img src="Docker%20for%20Pentesters_files/container_vs_vm.png" alt="Container vs VM"></p>
<p>But that doesn't really explain much. Conceptually I always 
understood how containers technically differed from VMs, but I didn't 
understand the benefit to me. Now I won't go in to the benefit of 
containers for an organization (although I could easily!), but I'll 
focus on how Docker improves my workflow as a pentester (and developer).</p>
<p>I use Docker containers as <strong><em>fast</em></strong>, <strong><em>purpose built</em></strong>, <strong><em>disposable</em></strong>
 environments for testing things and running applications. I think of 
containers less as a "Virtual Machine", and more as a self-contained 
executable or a "virtualenv" for an OS. And no matter what machine I am 
on (work, personal, etc), I will always have the exact same experience.</p>
<p>In the following examples, hopefully you'll see the benefits of 
Docker containers. If you're of the camp that "VM's are still better", I
 won't try to convince you. If your workflow is amazing with VMs, maybe 
even automated using Vagrant and Packer, that's awesome. Keep doing you.
 This works for me and I just wanted to share :)</p>
<h2 id="usefuldockeraliases">Useful Docker Aliases</h2>
<p>I make heavy use of aliases when using Docker. These are an absolute 
life saver to me, and IMO should be added for anyone using Docker:</p>
<pre class=" language-bash"><code class=" language-bash"><span class="token function">alias</span> dockershell<span class="token operator">=</span><span class="token string">"docker run --rm -i -t --entrypoint=/bin/bash"</span>  
<span class="token function">alias</span> dockershellsh<span class="token operator">=</span><span class="token string">"docker run --rm -i -t --entrypoint=/bin/sh"</span>

<span class="token keyword">function</span> dockershellhere<span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>  
    dirname<span class="token operator">=</span>$<span class="token punctuation">{</span>PWD<span class="token comment" spellcheck="true">##*/}</span>
    docker run --rm -it --entrypoint<span class="token operator">=</span>/bin/bash -v <span class="token variable"><span class="token variable">`</span><span class="token function">pwd</span><span class="token variable">`</span></span>:/<span class="token variable">${dirname}</span> -w /<span class="token variable">${dirname}</span> <span class="token string">"<span class="token variable">$@</span>"</span>
<span class="token punctuation">}</span>
<span class="token keyword">function</span> dockershellshhere<span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>  
    dirname<span class="token operator">=</span>$<span class="token punctuation">{</span>PWD<span class="token comment" spellcheck="true">##*/}</span>
    docker run --rm -it --entrypoint<span class="token operator">=</span>/bin/sh -v <span class="token variable"><span class="token variable">`</span><span class="token function">pwd</span><span class="token variable">`</span></span>:/<span class="token variable">${dirname}</span> -w /<span class="token variable">${dirname}</span> <span class="token string">"<span class="token variable">$@</span>"</span>
<span class="token punctuation">}</span>
</code></pre>
<p>What do these do? They simply let me specify an image and drop into 
an interactive shell in a fresh, disposable environment. I can look 
around, make changes, test things, and then when I'm finished and type 
"exit", everything is destroyed and cleaned up.</p>
<p><code>dockershell</code> executes <code>/bin/bash</code>, while <code>dockershellsh</code> executes <code>/bin/sh</code>. This is useful since not every Docker image has bash installed.</p>
<p>The ones that end in <code>here</code> take it one step further and 
mount my current working directory inside the disposable container. This
 lets me interact with my files inside the disposable environment, and 
anything I write to that directory while inside the container persists 
after exit.</p>
<p>For example: <br>
<img src="Docker%20for%20Pentesters_files/dockershell_ubuntu.png" alt="dockershell ubuntu"></p>
<p>No spinning up a VM, no SSH, just instant shell access to test 
something out. And when I'm done it's destroyed and the next time I run 
it I have a fresh instance again.</p>
<p>I'll use these aliases a lot in the examples below.</p>
<h1 id="example1exploringotheross">Example 1 - Exploring other OSs</h1>
<p>Early on in my pentest career, I would find myself with either a 
blind command injection or LFI on a server but didn't really know what 
to look for. I spent hours spinning up VMs to match the OS version or 
application stack just to do some local reconnaissance to know what to 
look for. With Docker this is painless now.</p>
<p>Let's say I have LFI on a Tomcat 6 box - what files exist that I 
should go after? I'll just drop into a shell on a Tomcat 6 docker image 
and go exploring:</p>
<p><img src="Docker%20for%20Pentesters_files/dockershell_tomcat.png" alt="dockershell tomcat6"></p>
<p>This pulls the official Tomcat 6 Docker image which is based on 
Debian 8 and has Tomcat pre-installed. I can start exploring the 
configuration files and figure out which ones exist and might contain 
sensitive information (e.g. <code>conf/server.xml</code> or <code>conf/tomcat-users.xml</code>)</p>
<p>Or what if I found an old CentOS box and need to know what version of
 glibc is on it? Instead of downloading an ISO and booting a VM, I can 
use Docker:</p>
<p><img src="Docker%20for%20Pentesters_files/dockershell_centos.png" alt="dockershell centos"></p>
<p><em>Note: I highlighted my kernel version to demonstrate a point. I'm
 running on a very new Kernel because it's my Docker host's kernel - 
this is one of the key differences between containers and VMs</em></p>
<p>CentOS 4 appears to have glibc 2.3.4</p>
<h1 id="example2compilingcodeforoldtargets">Example 2 - Compiling Code for old targets</h1>
<p>Taking the last example one step further, what if I need to compile 
something to target an older version of glibc? Back when I was doing 
boot2roots and CTFs this came up all the time. I needed to compile a 
specific exploit for a specific version - and often I would download an 
entire ISO and create a VM just to compile a single file. But now I can 
do it in Docker easily.</p>
<p>First, I need to install the necessary build tools in a CentOS 5 docker image:</p>
<pre><code>yum install -y perl curl wget gcc c++ make glibc-devel glibc-devel.i386  
</code></pre>
<p>But! The official CentOS 5 image doesn't have up-to-date sources to 
actually install anything. A little bit of Googling and somebody fixed 
that for me: <a href="https://hub.docker.com/r/astj/centos5-vault/">https://hub.docker.com/r/astj/centos5-vault/</a></p>
<p>Now I can just <code>dockershell</code> into <code>astj/centos5-vaule</code>
 and run the yum commands. However, it's annoying to reinstall all the 
build tools every time I need them. So let's create another Docker 
image! This is another reason Docker is awesome - I'll just create a 
purpose-built image that instantly gets me a CentOS 5 box with all the 
build tools I need. And in terms of storage, this doesn't create a copy 
or a clone of the CentOS 5 image - I'm just creating another layer on 
top it. </p>
<script src="Docker%20for%20Pentesters_files/6cb1dfbac11e990b9f5b08d1afd7fdcb.js"></script><link rel="stylesheet" href="Docker%20for%20Pentesters_files/gist-embed-a9a1cf2ca01efd362bfa52312712ae94.css"><div id="gist97272220" class="gist">
    <div class="gist-file">
      <div class="gist-data">
        <div class="js-gist-file-update-container js-task-list-container file-box">
  <div id="file-dockerfile" class="file">
    

  <div itemprop="text" class="Box-body p-0 blob-wrapper data type-dockerfile ">
      
<table class="highlight tab-size js-file-line-container" data-tab-size="8">
      <tbody><tr>
        <td id="file-dockerfile-L1" class="blob-num js-line-number" data-line-number="1"></td>
        <td id="file-dockerfile-LC1" class="blob-code blob-code-inner js-file-line"><span class="pl-k">ARG</span> CENTOSIMAGE=astj/centos5-vault</td>
      </tr>
      <tr>
        <td id="file-dockerfile-L2" class="blob-num js-line-number" data-line-number="2"></td>
        <td id="file-dockerfile-LC2" class="blob-code blob-code-inner js-file-line">
</td>
      </tr>
      <tr>
        <td id="file-dockerfile-L3" class="blob-num js-line-number" data-line-number="3"></td>
        <td id="file-dockerfile-LC3" class="blob-code blob-code-inner js-file-line"><span class="pl-k">FROM</span> ${CENTOSIMAGE}</td>
      </tr>
      <tr>
        <td id="file-dockerfile-L4" class="blob-num js-line-number" data-line-number="4"></td>
        <td id="file-dockerfile-LC4" class="blob-code blob-code-inner js-file-line"><span class="pl-k">RUN</span> yum install -y perl curl wget gcc c++ make glibc-devel glibc-devel.i386</td>
      </tr>
</tbody></table>


  </div>

  </div>
</div>

      </div>
      <div class="gist-meta">
        <a href="https://gist.github.com/ropnop/6cb1dfbac11e990b9f5b08d1afd7fdcb/raw/11bc8372932cf126d6155e9e0d81cd90c23fb989/Dockerfile" style="float:right">view raw</a>
        <a href="https://gist.github.com/ropnop/6cb1dfbac11e990b9f5b08d1afd7fdcb#file-dockerfile">Dockerfile</a>
        hosted with ❤ by <a href="https://github.com/">GitHub</a>
      </div>
    </div>
</div>

<p>I can now build this with <code>docker build -t rflathers/centos-devel .</code>. <em>Note by specifying a build arg, I can also change the CentOS base image on the command line, e.g. by adding <code>--build-arg CENTOSIMAGE=2k0ri/centos4-64-vault</code></em></p>
<p>Now I can use <code>dockershellhere</code> with my new Docker image and compile an exploit whenever I need it:</p>
<p><img src="Docker%20for%20Pentesters_files/dockershellhere_dirtycow.png" alt="compile dirtycow"></p>
<p>Setting up repeatable build environments is one of the most useful 
features of Docker if you're a developer. It's exactly how I build the <a href="https://github.com/ropnop/impacket_static_binaries">static impacket binaries</a>.
 It took me a long time to figure out the right combination of glibc and
 pyinstaller, so I created a Docker image I can always reliably build 
them in and call that from my <a href="https://github.com/ropnop/impacket_static_binaries/blob/master/.circleci/config.yml#L5">CI pipeline</a>.</p>
<h1 id="example3impacket">Example 3 - Impacket</h1>
<p>This brings me to my next use case: running tools that require 
specific dependencies and or environments. Take for example, the amazing
 <a href="https://github.com/SecureAuthCorp/impacket">Impacket project</a>.
 Impacket has gotten much easier to install (and now supports Python 3!)
 but it still has a bunch of dependencies. Sure, you can use a Python 
virtual environment, but then you still need to initialize a Python 
virtual environment and activate it whenever you want to run Impacket.</p>
<p>Like I mentioned earlier, I treat Docker images like pre-packaged, 
standalone executables. So in this case, I'll just package and install 
Impacket directly into a light weight Python container. To do that, I 
added a Dockerfile inside the Impacket directory, copied over all the 
source code, installed all the dependencies and set the <code>WORKDIR</code> and <code>CMD</code> so that when the Docker container is staretd I'm ready to run Impacket:</p>
<script src="Docker%20for%20Pentesters_files/887383ea8539f4e528ec10ee947bbcc1.js"></script><link rel="stylesheet" href="Docker%20for%20Pentesters_files/gist-embed-a9a1cf2ca01efd362bfa52312712ae94.css"><div id="gist97272258" class="gist">
    <div class="gist-file">
      <div class="gist-data">
        <div class="js-gist-file-update-container js-task-list-container file-box">
  <div id="file-dockerfile" class="file">
    

  <div itemprop="text" class="Box-body p-0 blob-wrapper data type-dockerfile ">
      
<table class="highlight tab-size js-file-line-container" data-tab-size="8">
      <tbody><tr>
        <td id="file-dockerfile-L1" class="blob-num js-line-number" data-line-number="1"></td>
        <td id="file-dockerfile-LC1" class="blob-code blob-code-inner js-file-line"><span class="pl-k">FROM</span> python:2.7-alpine</td>
      </tr>
      <tr>
        <td id="file-dockerfile-L2" class="blob-num js-line-number" data-line-number="2"></td>
        <td id="file-dockerfile-LC2" class="blob-code blob-code-inner js-file-line"><span class="pl-k">RUN</span> apk --update --no-cache add \</td>
      </tr>
      <tr>
        <td id="file-dockerfile-L3" class="blob-num js-line-number" data-line-number="3"></td>
        <td id="file-dockerfile-LC3" class="blob-code blob-code-inner js-file-line">    zlib-dev \</td>
      </tr>
      <tr>
        <td id="file-dockerfile-L4" class="blob-num js-line-number" data-line-number="4"></td>
        <td id="file-dockerfile-LC4" class="blob-code blob-code-inner js-file-line">    musl-dev \</td>
      </tr>
      <tr>
        <td id="file-dockerfile-L5" class="blob-num js-line-number" data-line-number="5"></td>
        <td id="file-dockerfile-LC5" class="blob-code blob-code-inner js-file-line">    libc-dev \</td>
      </tr>
      <tr>
        <td id="file-dockerfile-L6" class="blob-num js-line-number" data-line-number="6"></td>
        <td id="file-dockerfile-LC6" class="blob-code blob-code-inner js-file-line">    gcc \</td>
      </tr>
      <tr>
        <td id="file-dockerfile-L7" class="blob-num js-line-number" data-line-number="7"></td>
        <td id="file-dockerfile-LC7" class="blob-code blob-code-inner js-file-line">    libffi-dev \</td>
      </tr>
      <tr>
        <td id="file-dockerfile-L8" class="blob-num js-line-number" data-line-number="8"></td>
        <td id="file-dockerfile-LC8" class="blob-code blob-code-inner js-file-line">    openssl-dev &amp;&amp; \</td>
      </tr>
      <tr>
        <td id="file-dockerfile-L9" class="blob-num js-line-number" data-line-number="9"></td>
        <td id="file-dockerfile-LC9" class="blob-code blob-code-inner js-file-line">    rm -rf /var/cache/apk/*</td>
      </tr>
      <tr>
        <td id="file-dockerfile-L10" class="blob-num js-line-number" data-line-number="10"></td>
        <td id="file-dockerfile-LC10" class="blob-code blob-code-inner js-file-line"><span class="pl-k">RUN</span> mkdir -p /opt/impacket</td>
      </tr>
      <tr>
        <td id="file-dockerfile-L11" class="blob-num js-line-number" data-line-number="11"></td>
        <td id="file-dockerfile-LC11" class="blob-code blob-code-inner js-file-line"><span class="pl-k">COPY</span> . /opt/impacket</td>
      </tr>
      <tr>
        <td id="file-dockerfile-L12" class="blob-num js-line-number" data-line-number="12"></td>
        <td id="file-dockerfile-LC12" class="blob-code blob-code-inner js-file-line"><span class="pl-k">WORKDIR</span> /opt/impacket</td>
      </tr>
      <tr>
        <td id="file-dockerfile-L13" class="blob-num js-line-number" data-line-number="13"></td>
        <td id="file-dockerfile-LC13" class="blob-code blob-code-inner js-file-line"><span class="pl-k">RUN</span> pip install .</td>
      </tr>
      <tr>
        <td id="file-dockerfile-L14" class="blob-num js-line-number" data-line-number="14"></td>
        <td id="file-dockerfile-LC14" class="blob-code blob-code-inner js-file-line"><span class="pl-k">WORKDIR</span> /opt/impacket/examples</td>
      </tr>
      <tr>
        <td id="file-dockerfile-L15" class="blob-num js-line-number" data-line-number="15"></td>
        <td id="file-dockerfile-LC15" class="blob-code blob-code-inner js-file-line"><span class="pl-k">CMD</span> [<span class="pl-s">"python"</span>]</td>
      </tr>
</tbody></table>


  </div>

  </div>
</div>

      </div>
      <div class="gist-meta">
        <a href="https://gist.github.com/ropnop/887383ea8539f4e528ec10ee947bbcc1/raw/47019095f6d855ee6ec8b9cac024b42ef7c51291/Dockerfile" style="float:right">view raw</a>
        <a href="https://gist.github.com/ropnop/887383ea8539f4e528ec10ee947bbcc1#file-dockerfile">Dockerfile</a>
        hosted with ❤ by <a href="https://github.com/">GitHub</a>
      </div>
    </div>
</div>

<p>Running <code>docker build -t rflathers/impacket .</code> builds a standalone container image with Impacket installed I can execute whenever I want to run Impacket (which is often!)</p>
<p>This is another difference between VMs and Containers. It would be 
way overkill to spin up an entire Linux VM and load a snapshot whenever I
 want to run Impacket. But Docker is so fast and easy, I have no 
problems loading an entire OS just to run Impacket.</p>
<p>Now to run Impacket, I could just <code>dockershell</code> into the image and run Impacket from the prompt.</p>
<p>However, I can save that step and call everything in one command. By setting the <code>CMD</code> and <code>WORKDIR</code> in the Dockerfile, whenever I do a <code>docker run</code>,
 I am already in the examples directory and "python" is called. Any 
arguments I pass to it are passed on as well. This leads to my another 
one of my favorite aliases:</p>
<pre><code>alias impacket="docker run --rm -it rflathers/impacket"  
</code></pre>
<p>Now I can run any Impacket example just by typing "impacket":</p>
<p><img src="Docker%20for%20Pentesters_files/impacket_alias_wmiexec.png" alt="impacket alias"></p>
<p>Easy!</p>
<h1 id="example4smbserverwithimpacket">Example 4 - SMB Server with Impacket</h1>
<p>The above Impacket examples work because they are only initiating 
outbound connections and don't need to listen for any traffic. If my 
running container needs to listen on any ports, it won't work unless I 
explicitly forward them. But this is easy with Docker as well, and easy 
to alias.</p>
<p>How can I start a listening SMB server with Impacket? I can just forward port 445 to the container when I start it with <code>-p 445:445</code>.
 But since my containers are disposable, any files I receive will be 
lost as soon as the command exits. And I can only serve files that are 
built into the image. So I combine it with a volume mount, just like I 
do with <code>dockershellhere</code> to serve up my current directory! This time I'll define a new bash function in my aliases file:</p>
<pre class=" language-bash"><code class=" language-bash">smbservehere<span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>  
    local sharename
    <span class="token punctuation">[</span><span class="token punctuation">[</span> -z <span class="token variable">$1</span> <span class="token punctuation">]</span><span class="token punctuation">]</span> <span class="token operator">&amp;&amp;</span> sharename<span class="token operator">=</span><span class="token string">"SHARE"</span> <span class="token operator">||</span> sharename<span class="token operator">=</span><span class="token variable">$1</span>
    docker run --rm -it -p 445:445 -v <span class="token string">"<span class="token variable">${PWD}</span>:/tmp/serve"</span> rflathers/impacket smbserver.py -smb2support <span class="token variable">$sharename</span> /tmp/serve
<span class="token punctuation">}</span>
</code></pre>
<p>What this function does is mount the current directory into <code>/tmp/serve</code> and then use Impacket's <code>smbserver.py</code>
 to create a share at that directory. I can also supply an argument to 
name the share, or it defaults to just "SHARE". Running this alias lets 
me really quickly serve up a directory over an open SMB share. For 
example, say I generated a payload in <code>/tmp/payloads</code> and need to share it to a Windows victim quick. From that directory on my host:</p>
<p><img src="Docker%20for%20Pentesters_files/smbservehere.png" alt="smbservehere"></p>
<p>And then from my Windows victim, I can hit my host IP address (since 
445 is mapped and open) and I'm talking to the Impacket container which 
is serving up a payload from my Mac:</p>
<p><img src="Docker%20for%20Pentesters_files/windows_smb_share.png" alt="windows dir payloads"></p>
<p>When I Ctrl-C to quit the server the container is destroyed but any files transferred remain.</p>
<h1 id="example5servinghttpfiles">Example 5 - Serving HTTP Files</h1>
<p>What about HTTP files? There's lots of ways to quickly spin up an HTTP server. The classic <code>python -m SimpleHTTPServer</code>
 (for Python 2) was my go-to for a long time, but after I went down the 
Docker rabbit hole there was no coming back. Why not use a proper server
 (reverse-proxy) like Nginx? And what about HTTPS?</p>
<p>There is an official <a href="https://hub.docker.com/_/nginx">nginx docker image</a>
 that makes this easy, but I wanted to customize it a bit. I also wanted
 the server to listen on 443 with a self-signed certificate. Yes the 
cert wouldn't be trusted, but the communication would be encrypted.</p>
<p>To do this I added the <code>openssl</code> binary to the Nginx image and copied in a <a href="https://github.com/ropnop/dockerfiles/blob/master/nginxserve/default.conf">custom Nginx config</a> that listens on both 80 and 443 and uses a certificate and a key. I also added a custom start script</p>
<script src="Docker%20for%20Pentesters_files/7b11807b99e223600335d199724f03c3.js"></script><link rel="stylesheet" href="Docker%20for%20Pentesters_files/gist-embed-a9a1cf2ca01efd362bfa52312712ae94.css"><div id="gist97272360" class="gist">
    <div class="gist-file">
      <div class="gist-data">
        <div class="js-gist-file-update-container js-task-list-container file-box">
  <div id="file-dockerfile" class="file">
    

  <div itemprop="text" class="Box-body p-0 blob-wrapper data type-dockerfile ">
      
<table class="highlight tab-size js-file-line-container" data-tab-size="8">
      <tbody><tr>
        <td id="file-dockerfile-L1" class="blob-num js-line-number" data-line-number="1"></td>
        <td id="file-dockerfile-LC1" class="blob-code blob-code-inner js-file-line"><span class="pl-k">FROM</span> nginx:stable</td>
      </tr>
      <tr>
        <td id="file-dockerfile-L2" class="blob-num js-line-number" data-line-number="2"></td>
        <td id="file-dockerfile-LC2" class="blob-code blob-code-inner js-file-line"><span class="pl-k">RUN</span> apt-get update &amp;&amp; apt-get install -y openssl</td>
      </tr>
      <tr>
        <td id="file-dockerfile-L3" class="blob-num js-line-number" data-line-number="3"></td>
        <td id="file-dockerfile-LC3" class="blob-code blob-code-inner js-file-line"><span class="pl-k">RUN</span> mkdir -p /etc/nginx/ssl &amp;&amp; mkdir -p /srv/data</td>
      </tr>
      <tr>
        <td id="file-dockerfile-L4" class="blob-num js-line-number" data-line-number="4"></td>
        <td id="file-dockerfile-LC4" class="blob-code blob-code-inner js-file-line">
</td>
      </tr>
      <tr>
        <td id="file-dockerfile-L5" class="blob-num js-line-number" data-line-number="5"></td>
        <td id="file-dockerfile-LC5" class="blob-code blob-code-inner js-file-line"><span class="pl-k">COPY</span> default.conf /etc/nginx/conf.d/</td>
      </tr>
      <tr>
        <td id="file-dockerfile-L6" class="blob-num js-line-number" data-line-number="6"></td>
        <td id="file-dockerfile-LC6" class="blob-code blob-code-inner js-file-line"><span class="pl-k">COPY</span> start.sh /</td>
      </tr>
      <tr>
        <td id="file-dockerfile-L7" class="blob-num js-line-number" data-line-number="7"></td>
        <td id="file-dockerfile-LC7" class="blob-code blob-code-inner js-file-line"><span class="pl-k">ENTRYPOINT</span> [ <span class="pl-s">"/start.sh"</span> ]</td>
      </tr>
</tbody></table>


  </div>

  </div>
</div>

      </div>
      <div class="gist-meta">
        <a href="https://gist.github.com/ropnop/7b11807b99e223600335d199724f03c3/raw/e268870ad41edd64a4ddb114679bb817cd921739/Dockerfile" style="float:right">view raw</a>
        <a href="https://gist.github.com/ropnop/7b11807b99e223600335d199724f03c3#file-dockerfile">Dockerfile</a>
        hosted with ❤ by <a href="https://github.com/">GitHub</a>
      </div>
    </div>
</div>

<p>In this example, I use the <code>ENTRYPOINT</code> directive that will call my <code>start.sh</code>
 script whenever a container is created. This start script generates a 
new random key and self-signed certificate in the correct location for 
Nginx and then starts the server:</p>
<pre class=" language-bash"><code class=" language-bash"><span class="token shebang important">#!/bin/bash</span>

<span class="token keyword">if</span> <span class="token punctuation">[</span><span class="token punctuation">[</span> <span class="token operator">!</span> -f /etc/nginx/ssl/server.crt <span class="token operator">||</span> <span class="token operator">!</span> -f /etc/nginx/ssl/server.crt <span class="token punctuation">]</span><span class="token punctuation">]</span><span class="token punctuation">;</span> <span class="token keyword">then</span>  
    openssl req -x509 -nodes -days 365 -newkey rsa:2048 -keyout /etc/nginx/ssl/server.key -out /etc/nginx/ssl/server.crt -subj <span class="token string">'/CN=www.example.com'</span> 
<span class="token keyword">fi</span>

nginx -g <span class="token string">'daemon off;'</span>  
</code></pre>
<p>When this Docker image is launched, a new key and certificate are <em>always</em> generated before Nginx starts listening on 80 and 443. I built the image with <code>docker build -t rflathers/nginxserve .</code></p>
<p>To run this example, I need to do two things: mount the files I want to serve into the right directory (<code>/srv/data</code>), and forward ports 80/443. Putting it all together, I use another alias:</p>
<pre class=" language-bash"><code class=" language-bash"><span class="token function">alias</span> nginxhere<span class="token operator">=</span><span class="token string">'docker run --rm -it -p 80:80 -p 443:443 -v "<span class="token variable">${PWD}</span>:/srv/data" rflathers/nginxserve'</span>  
</code></pre>
<p>Running this alias in a directory I want to serve let's me browse to it over 80 and 443 (HTTPS):</p>
<p><img src="Docker%20for%20Pentesters_files/nginxhere.png" alt="nginxhere"></p>
<p>And I can browse the contents with a browser, or use curl/wget/invoke-webrequest:</p>
<p><img src="Docker%20for%20Pentesters_files/nginxlocalhost.png" alt="browser files"></p>
<h1 id="example6servingfilesoverwebdav">Example 6 - Serving Files over WebDav</h1>
<p>A while back I saw a great post by TrustedSec on how to quickly spin up a <a href="https://www.trustedsec.com/2018/06/how-to-set-up-a-quick-simple-webdav-server-for-remote-file-sharing/">WebDav server on a VPS</a>. It's a great post and gave me the idea that it would be even easier with Docker.</p>
<p>I use the same Python WebDav package in the post, but Dockerized it:</p>
<script src="Docker%20for%20Pentesters_files/40f054892eae531d81ff2e9716df75e8.js"></script><link rel="stylesheet" href="Docker%20for%20Pentesters_files/gist-embed-a9a1cf2ca01efd362bfa52312712ae94.css"><div id="gist97272527" class="gist">
    <div class="gist-file">
      <div class="gist-data">
        <div class="js-gist-file-update-container js-task-list-container file-box">
  <div id="file-dockerfile" class="file">
    

  <div itemprop="text" class="Box-body p-0 blob-wrapper data type-dockerfile ">
      
<table class="highlight tab-size js-file-line-container" data-tab-size="8">
      <tbody><tr>
        <td id="file-dockerfile-L1" class="blob-num js-line-number" data-line-number="1"></td>
        <td id="file-dockerfile-LC1" class="blob-code blob-code-inner js-file-line"><span class="pl-k">FROM</span> python:alpine</td>
      </tr>
      <tr>
        <td id="file-dockerfile-L2" class="blob-num js-line-number" data-line-number="2"></td>
        <td id="file-dockerfile-LC2" class="blob-code blob-code-inner js-file-line"><span class="pl-k">RUN</span> pip install wsgidav cheroot</td>
      </tr>
      <tr>
        <td id="file-dockerfile-L3" class="blob-num js-line-number" data-line-number="3"></td>
        <td id="file-dockerfile-LC3" class="blob-code blob-code-inner js-file-line"><span class="pl-k">RUN</span> mkdir -p /webdav/share &amp;&amp; mkdir -p /srv/data/share</td>
      </tr>
      <tr>
        <td id="file-dockerfile-L4" class="blob-num js-line-number" data-line-number="4"></td>
        <td id="file-dockerfile-LC4" class="blob-code blob-code-inner js-file-line"><span class="pl-k">COPY</span> run.sh /webdav/</td>
      </tr>
      <tr>
        <td id="file-dockerfile-L5" class="blob-num js-line-number" data-line-number="5"></td>
        <td id="file-dockerfile-LC5" class="blob-code blob-code-inner js-file-line"><span class="pl-k">WORKDIR</span> /webdav/</td>
      </tr>
      <tr>
        <td id="file-dockerfile-L6" class="blob-num js-line-number" data-line-number="6"></td>
        <td id="file-dockerfile-LC6" class="blob-code blob-code-inner js-file-line"><span class="pl-k">ENTRYPOINT</span> <span class="pl-s">"/webdav/run.sh"</span></td>
      </tr>
</tbody></table>


  </div>

  </div>
</div>

      </div>
      <div class="gist-meta">
        <a href="https://gist.github.com/ropnop/40f054892eae531d81ff2e9716df75e8/raw/b978e20ed267eb4592fffcf8f660a423c8d4e751/Dockerfile" style="float:right">view raw</a>
        <a href="https://gist.github.com/ropnop/40f054892eae531d81ff2e9716df75e8#file-dockerfile">Dockerfile</a>
        hosted with ❤ by <a href="https://github.com/">GitHub</a>
      </div>
    </div>
</div>

<p>The <code>run.sh</code> script simply executes the server on port 80 and serves files anonymously from <code>/srv/data/</code>:</p>
<pre class=" language-bash"><code class=" language-bash"><span class="token shebang important">#!/bin/sh</span>
wsgidav --host<span class="token operator">=</span>0.0.0.0 --port<span class="token operator">=</span>80 --root<span class="token operator">=</span>/srv/data/ --auth<span class="token operator">=</span>anonymous  
</code></pre>
<p>To run this Docker image, just like with Nginx, I mount whatever files I want to share into <code>/srv/data/share</code> and expose port 80. Of course I use another alias:</p>
<pre class=" language-bash"><code class=" language-bash"><span class="token function">alias</span> webdavhere<span class="token operator">=</span><span class="token string">'docker run --rm -it -p 80:80 -v "<span class="token variable">${PWD}</span>:/srv/data/share" rflathers/webdav'</span>  
</code></pre>
<p>Now say I want to share some payloads over WebDav on port 80, I can <code>cd</code> to the directory and run <code>webdavhere</code>:</p>
<p><img src="Docker%20for%20Pentesters_files/webdavhere.png" alt="webdavhere"></p>
<p>From Windows, I can browse to the WebDav share by a UNC path: <code>\\192.168.98.1@80\share</code>:</p>
<p><img src="Docker%20for%20Pentesters_files/windows_webdavshare.png" alt="webdav files"></p>
<h1 id="example6servingfilesbehindnatwithngrok">Example 6 - Serving Files behind NAT with Ngrok</h1>
<p>Serving files over HTTP/SMB/WebDav etc is great and easy with Docker,
 but what if my victim doesn't have a route back to me (e.g. I'm NAT'd)?
 </p>
<p>Well you could definitely run all the above examples on an internet 
facing VPS with Docker installed. In fact, Digital Ocean has a prebuilt <a href="https://cloud.digitalocean.com/marketplace/5ba19751fc53b8179c7a0071">droplet with Docker</a> installed that could get you going really quickly.</p>
<p>But in keeping with the spirit of "disposable", I like to avoid VPSs.
 And since I use these container servers for single purposes and don't 
leave them running - I'm fine just exposing ports when I need them. 
Enter <a href="https://ngrok.com/">ngrok</a>.</p>
<p>Ngrok is an awesome, free utility that takes away the complication of
 SSH port forwarding and need for a VPS. With a single command, I can 
expose a port on my localhost to the internet behind a random domain 
name with trusted TLS. To get started, just <a href="https://dashboard.ngrok.com/get-started">sign up and download</a>.</p>
<p>Now with Ngrok, I can run one extra command to expose my local Docker
 container to the internet with a random URL. To see it in action, I'll <code>cd</code> to my payloads directory and run <code>nginxhere</code>. In another terminal window, I start an ngrok session with <code>ngrok http 80</code>. This command tells ngrok to forward localhost:80 and to use HTTP.</p>
<p><img src="Docker%20for%20Pentesters_files/nginx_ngrok-1.png" alt="nginxhere ngrok"></p>
<p>The ngrok output displays two URLs, one for HTTP, one for HTTPS (with
 a trusted cert for free!). Now any machine can browse to these URLs and
 hit my local Nginx server:</p>
<p><img src="Docker%20for%20Pentesters_files/ngrok_browser.png" alt="ngrok http serve"></p>
<p>After my file is downloaded, I can Ctrl-C both ngrok and the Docker 
container and move on to the next task. This might be the easiest way 
I've found yet to quickly serve a file over the internet.</p>
<p>It also works great with the WebDav container! Running <code>webdavhere</code> followed by <code>ngrok http 80</code> gives a public URL you can treat like an SMB share:</p>
<p><img src="Docker%20for%20Pentesters_files/ngrok_webdav.png" alt="ngrok webdav serve"></p>
<p>For non-HTTP traffic, such as Impacket's smbserver, you have to use <code>ngrok tcp 445</code>.
 Unfortunately, it won't map to an external 445 port (it will be a high 
numbered port). This means you probably can't use it - I'd recommend 
going dedicated VPS or SSH tunnels to serve SMB over the internet.</p>
<h1 id="example7metasploit">Example 7 - Metasploit</h1>
<p>I don't use Metasploit much anymore to be honest (it's been replaced 
by Powerpoint and Excel in my professional life...ugh), but when I do 
I'm spinning it up for a very specific reason to test something. Running
 Kali or having Metasploit installed on my Mac is overkill (and usually 
flags my corporate AV haha) - but running Metasploit in Docker is really
 convenient for quick tests.</p>
<p>Metasploit has an <a href="https://hub.docker.com/r/metasploitframework/metasploit-framework/">official Docker image</a>
 that is in lock-step with the latest version of Metasploit from Github.
 It's possible to drop right into an msfconsole session with:</p>
<pre class=" language-bash"><code class=" language-bash">docker run --rm -it metasploitframework/metasploit-framework ./msfconsole  
</code></pre>
<p>Metasploit stores session info, preferences and loot in the home directory at <code>/home/msf/.msf4</code>.
 Since this is a disposable container, after an exit everything would be
 lost - unless we volume mount a directory from our host. So I mount in 
my own <code>~/.msf4</code> directory that gets shared across every disposable container I spin up:</p>
<pre class=" language-bash"><code class=" language-bash"><span class="token function">alias</span> metasploit<span class="token operator">=</span><span class="token string">'docker run --rm -it -v "<span class="token variable">${HOME}</span>/.msf4:/home/msf/.msf4" metasploitframework/metasploit-framework ./msfconsole'</span>  
</code></pre>
<p>However, catching reverse metrepreter shells is half the fun of 
Metasploit, and you can't do that if you don't port forward. Since I 
don't always know what port(s) I want my payloads to use, it's possible 
to forward a range of ports, <em>even if they're not being used when the container is launched</em>. This is my next alias:</p>
<pre class=" language-bash"><code class=" language-bash"><span class="token function">alias</span> metasploitports<span class="token operator">=</span><span class="token string">'docker run --rm -it -v "<span class="token variable">${HOME}</span>/.msf4:/home/msf/.msf4" -p 8443-8500:8443-8500 metasploitframework/metasploit-framework ./msfconsole'</span>  
</code></pre>
<p>This forwards every port from 8443-8500 when metasploit is launched. 
As long as I set a listener somewhere in that range - I can catch it. 
Putting it all together, it works great on a local network:</p>
<p><img src="Docker%20for%20Pentesters_files/dockermetasploit_psexec.png" alt="msfconsole psexec"></p>
<p>If you wanna get really creative, you can also chain it with <code>ngrok</code>
 forwarding to catch reverse shells back through the internet to your 
local Metasploit container. I'll leave that to a reader exercise, but 
rest-assured it works :)</p>
<p><img src="Docker%20for%20Pentesters_files/metasploit_ngrok.png" alt="metasploit ngrok"></p>
<h1 id="example8msfvenom">Example 8 - msfvenom</h1>
<p>Another quick example about metasploit since it's not always just about <code>msfconsole</code>. I use <code>msfvenom</code>
 to generate payloads for PoCs and testing, and I can use the metasploit
 Docker image for this really easily. Since I need to save the output, I
 mount my current directory to the container, run the <code>msfvenom</code> command and save the payload. I have an alias for this also:</p>
<pre class=" language-bash"><code class=" language-bash"><span class="token function">alias</span> msfvenomhere<span class="token operator">=</span><span class="token string">'docker run --rm -it -v "<span class="token variable">${HOME}</span>/.msf4:/home/msf/.msf4" -v "<span class="token variable">${PWD}</span>:/data" metasploitframework/metasploit-framework ./msfvenom'</span>  
</code></pre>
<p>The only catch is I need to make sure I save the generated file to <code>/data</code>. For example, I can generate a DLL with the Metapspoit container, serve it up with the WebDav one, and execute it on my victim:</p>
<p><img src="Docker%20for%20Pentesters_files/msfvenom_wedbav.png" alt="webdav dll">
<img src="Docker%20for%20Pentesters_files/dll_executed.png" alt="webdav dll executed"></p>
<h1 id="example9capturinghttpfiles">Example 9 - Capturing HTTP Files</h1>
<p>This example shows how I can run 2 of the functions I released with my <a href="https://blog.ropnop.com/serverless-toolkit-for-pentesters/">serverless toolkit</a>
 locally with Docker. It entirely fits with the theme of writing single 
use functions, packaging them up as Docker images, and running anywhere.</p>
<p>The first is a simple <a href="https://github.com/ropnop/dockerfiles/blob/master/reqdump/server.js">HTTP Request Dumper</a>.
 It's s simple JavaScript server that echos any HTTP request it receives
 it to stdout. This is really useful when testing for SSRF or needing to
 see if a blind command injection is working with <code>curl</code>. My alias for it is:</p>
<pre><code>alias reqdump='docker run --rm -it -p 80:3000 rflathers/reqdump'  
</code></pre>
<p>This starts a local listener on 80 (although it's entirely customizable). If it receives any HTTP request it prints it out:</p>
<p><img src="Docker%20for%20Pentesters_files/reqdump.png" alt="reqdump"></p>
<p>The next function is a bit more useful. I often times need to exfil a file <em>back</em>
 from a victim, and HTTP/S is the only allowed outbound traffic. This 
purpose-built Docker image starts a webserver that accepts any file 
POST'ed to it and saves it to disk. It's written in JavaScript with 
express (<a href="https://github.com/ropnop/dockerfiles/tree/master/postfiledump">source here</a>). I have an alias for it as well:</p>
<pre><code>alias postfiledumphere='docker run --rm -it -p80:3000 -v "${PWD}:/data" rflathers/postfiledump'  
</code></pre>
<p>Combining this with <code>ngrok</code> is really useful. I can spawn the container, then use <code>ngrok</code> to get a public URL with HTTPS. Now on my victim machine, I can use <code>curl</code> to POST any file back to me:</p>
<p><img src="Docker%20for%20Pentesters_files/postfiledump_ngrok.png" alt="postfiledump ngrok"></p>
<p>Easy encrypted exfil with a trusted TLS certificate!</p>
<h1 id="bonusexamplewindowscontainers">Bonus Example - Windows Containers</h1>
<p>This example is a bit more involved, but I think it's so cool I have to share. Credit to <a href="https://twitter.com/_xpn_">@<em>xpn</em></a> for sending me down this rabbit hole.</p>
<p>If you have a Windows machine, you can also run <em>Windows</em> 
containers, which utilize the Windows NT Kernel. Now this requires a 
Windows VM, but the beauty is you can interact with it from your own 
Docker CLI on Mac or Linux. It provides for a really seamless experience
 to drop into Windows shells in the exact same way I do above with 
Linux.</p>
<p>It's really easy to set up, thanks to this <a href="https://github.com/StefanScherer/windows-docker-machine">amazing project</a>. With Vagrant and Virtualbox installed on my Mac, I cloned the project and just ran:</p>
<pre><code>$ vagrant up --provider virtualbox 2019-box
</code></pre>
<p>After the box is downloaded and spun up, you will have a new Docker context:</p>
<pre><code>$ docker context ls
</code></pre>
<p><em>Note: you need the edge release of Docker installed for docker contexts, available <a href="https://docs.docker.com/docker-for-mac/edge-release-notes/">here</a></em></p>
<p>Now to run Windows Docker images, I just have to specify the new context with <code>-c 2019-box</code></p>
<p>Almost all the same techniques work as above on Windows images, but 
the main benefit of using Windows is to get access to the .NET Framework
 and msbuild. One of my favorite use cases is to write or edit C# code 
locally on my Mac, and use Docker to build the executables. </p>
<p>Of course, I have an alias for this too :) It mounts the current 
directory and drops me into a Windows shell in the directory. I just 
need to specify the Windows image I want to use. Usually one of the <a href="https://hub.docker.com/_/microsoft-dotnet-framework">official Microsoft images</a>:</p>
<pre class=" language-bash"><code class=" language-bash"><span class="token keyword">function</span> dockerwindowshellhere<span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>  
    dirname<span class="token operator">=</span>$<span class="token punctuation">{</span>PWD<span class="token comment" spellcheck="true">##*/}</span>
    docker -c 2019-box run --rm -it -v <span class="token string">"C:<span class="token variable">${PWD}</span>:C:/source"</span> -w <span class="token string">"C:/source"</span> <span class="token string">"<span class="token variable">$@</span>"</span>
<span class="token punctuation">}</span>
</code></pre>
<p>For example, with a fresh clone of <a href="https://github.com/GhostPack/Rubeus">Rubeus</a>, I can volume mount it into a Windows container with the .NET Framework build tools using my alias.</p>
<p>Inside this shell, I can execute <code>msbuild /t:Build /p:Configuration:Release</code>. After it finishes building and I exit the container, my built EXE is available on my Mac.</p>
<p><img src="Docker%20for%20Pentesters_files/rubeus_build.png" alt="build rubeus docker"></p>
<p>No matter how many times I do this, it still feels like black magic wizardry.</p>
<h1 id="conclusion">Conclusion</h1>
<p>Hopefully the above examples and aliases give you some ideas and 
inspiration for how Docker can improve your pentesting workflow.</p>
<p>If you have any other ideas or questions, please let me know! I love Dockerizing random things and expanding my aliases file :)</p>
<p>I have some ideas for my next post, where I can explore how to <em>abuse</em>
 Docker. I've got some really fun ideas on backdooring and hiding Docker
 containers and using Docker for persistence. Stay tuned!</p>
<p>-ropnop</p>
<h1 id="tldr">tl;dr</h1>
<p>Most of my Dockerfiles are here:</p>
<p><a href="https://github.com/ropnop/dockerfiles">https://github.com/ropnop/dockerfiles</a></p>
<p>You don't need to build them, either - every image mentioned is on Docker Hub:</p>
<p><a href="https://hub.docker.com/?namespace=rflathers">https://hub.docker.com/?namespace=rflathers</a></p>
<p>And here's most of my Docker aliases:</p>
<script src="Docker%20for%20Pentesters_files/c21c35e67a07da2ab50dbb8a085ccd22.js"></script><link rel="stylesheet" href="Docker%20for%20Pentesters_files/gist-embed-a9a1cf2ca01efd362bfa52312712ae94.css"><div id="gist97272978" class="gist">
    <div class="gist-file">
      <div class="gist-data">
        <div class="js-gist-file-update-container js-task-list-container file-box">
  <div id="file-docker_aliases-sh" class="file">
    

  <div itemprop="text" class="Box-body p-0 blob-wrapper data type-shell ">
      
<table class="highlight tab-size js-file-line-container" data-tab-size="8">
      <tbody><tr>
        <td id="file-docker_aliases-sh-L1" class="blob-num js-line-number" data-line-number="1"></td>
        <td id="file-docker_aliases-sh-LC1" class="blob-code blob-code-inner js-file-line"><span class="pl-k">function</span> <span class="pl-en">dockershell()</span> {</td>
      </tr>
      <tr>
        <td id="file-docker_aliases-sh-L2" class="blob-num js-line-number" data-line-number="2"></td>
        <td id="file-docker_aliases-sh-LC2" class="blob-code blob-code-inner js-file-line">    docker run --rm -i -t --entrypoint=/bin/bash <span class="pl-s"><span class="pl-pds">"</span><span class="pl-smi">$@</span><span class="pl-pds">"</span></span></td>
      </tr>
      <tr>
        <td id="file-docker_aliases-sh-L3" class="blob-num js-line-number" data-line-number="3"></td>
        <td id="file-docker_aliases-sh-LC3" class="blob-code blob-code-inner js-file-line">}</td>
      </tr>
      <tr>
        <td id="file-docker_aliases-sh-L4" class="blob-num js-line-number" data-line-number="4"></td>
        <td id="file-docker_aliases-sh-LC4" class="blob-code blob-code-inner js-file-line">
</td>
      </tr>
      <tr>
        <td id="file-docker_aliases-sh-L5" class="blob-num js-line-number" data-line-number="5"></td>
        <td id="file-docker_aliases-sh-LC5" class="blob-code blob-code-inner js-file-line"><span class="pl-k">function</span> <span class="pl-en">dockershellsh()</span> {</td>
      </tr>
      <tr>
        <td id="file-docker_aliases-sh-L6" class="blob-num js-line-number" data-line-number="6"></td>
        <td id="file-docker_aliases-sh-LC6" class="blob-code blob-code-inner js-file-line">    docker run --rm -i -t --entrypoint=/bin/sh <span class="pl-s"><span class="pl-pds">"</span><span class="pl-smi">$@</span><span class="pl-pds">"</span></span></td>
      </tr>
      <tr>
        <td id="file-docker_aliases-sh-L7" class="blob-num js-line-number" data-line-number="7"></td>
        <td id="file-docker_aliases-sh-LC7" class="blob-code blob-code-inner js-file-line">}</td>
      </tr>
      <tr>
        <td id="file-docker_aliases-sh-L8" class="blob-num js-line-number" data-line-number="8"></td>
        <td id="file-docker_aliases-sh-LC8" class="blob-code blob-code-inner js-file-line">
</td>
      </tr>
      <tr>
        <td id="file-docker_aliases-sh-L9" class="blob-num js-line-number" data-line-number="9"></td>
        <td id="file-docker_aliases-sh-LC9" class="blob-code blob-code-inner js-file-line"><span class="pl-k">function</span> <span class="pl-en">dockershellhere()</span> {</td>
      </tr>
      <tr>
        <td id="file-docker_aliases-sh-L10" class="blob-num js-line-number" data-line-number="10"></td>
        <td id="file-docker_aliases-sh-LC10" class="blob-code blob-code-inner js-file-line">    dirname=<span class="pl-smi">${PWD<span class="pl-k">##*/</span>}</span></td>
      </tr>
      <tr>
        <td id="file-docker_aliases-sh-L11" class="blob-num js-line-number" data-line-number="11"></td>
        <td id="file-docker_aliases-sh-LC11" class="blob-code blob-code-inner js-file-line">    docker run --rm -it --entrypoint=/bin/bash -v <span class="pl-s"><span class="pl-pds">`</span>pwd<span class="pl-pds">`</span></span>:/<span class="pl-smi">${dirname}</span> -w /<span class="pl-smi">${dirname}</span> <span class="pl-s"><span class="pl-pds">"</span><span class="pl-smi">$@</span><span class="pl-pds">"</span></span></td>
      </tr>
      <tr>
        <td id="file-docker_aliases-sh-L12" class="blob-num js-line-number" data-line-number="12"></td>
        <td id="file-docker_aliases-sh-LC12" class="blob-code blob-code-inner js-file-line">}</td>
      </tr>
      <tr>
        <td id="file-docker_aliases-sh-L13" class="blob-num js-line-number" data-line-number="13"></td>
        <td id="file-docker_aliases-sh-LC13" class="blob-code blob-code-inner js-file-line">
</td>
      </tr>
      <tr>
        <td id="file-docker_aliases-sh-L14" class="blob-num js-line-number" data-line-number="14"></td>
        <td id="file-docker_aliases-sh-LC14" class="blob-code blob-code-inner js-file-line"><span class="pl-k">function</span> <span class="pl-en">dockershellshhere()</span> {</td>
      </tr>
      <tr>
        <td id="file-docker_aliases-sh-L15" class="blob-num js-line-number" data-line-number="15"></td>
        <td id="file-docker_aliases-sh-LC15" class="blob-code blob-code-inner js-file-line">    docker run --rm -it --entrypoint=/bin/sh -v <span class="pl-s"><span class="pl-pds">`</span>pwd<span class="pl-pds">`</span></span>:/<span class="pl-smi">${dirname}</span> -w /<span class="pl-smi">${dirname}</span> <span class="pl-s"><span class="pl-pds">"</span><span class="pl-smi">$@</span><span class="pl-pds">"</span></span></td>
      </tr>
      <tr>
        <td id="file-docker_aliases-sh-L16" class="blob-num js-line-number" data-line-number="16"></td>
        <td id="file-docker_aliases-sh-LC16" class="blob-code blob-code-inner js-file-line">}</td>
      </tr>
      <tr>
        <td id="file-docker_aliases-sh-L17" class="blob-num js-line-number" data-line-number="17"></td>
        <td id="file-docker_aliases-sh-LC17" class="blob-code blob-code-inner js-file-line">
</td>
      </tr>
      <tr>
        <td id="file-docker_aliases-sh-L18" class="blob-num js-line-number" data-line-number="18"></td>
        <td id="file-docker_aliases-sh-LC18" class="blob-code blob-code-inner js-file-line"><span class="pl-k">function</span> <span class="pl-en">dockerwindowshellhere()</span> {</td>
      </tr>
      <tr>
        <td id="file-docker_aliases-sh-L19" class="blob-num js-line-number" data-line-number="19"></td>
        <td id="file-docker_aliases-sh-LC19" class="blob-code blob-code-inner js-file-line">    dirname=<span class="pl-smi">${PWD<span class="pl-k">##*/</span>}</span></td>
      </tr>
      <tr>
        <td id="file-docker_aliases-sh-L20" class="blob-num js-line-number" data-line-number="20"></td>
        <td id="file-docker_aliases-sh-LC20" class="blob-code blob-code-inner js-file-line">    docker -c 2019-box run --rm -it -v <span class="pl-s"><span class="pl-pds">"</span>C:<span class="pl-smi">${PWD}</span>:C:/source<span class="pl-pds">"</span></span> -w <span class="pl-s"><span class="pl-pds">"</span>C:/source<span class="pl-pds">"</span></span> <span class="pl-s"><span class="pl-pds">"</span><span class="pl-smi">$@</span><span class="pl-pds">"</span></span></td>
      </tr>
      <tr>
        <td id="file-docker_aliases-sh-L21" class="blob-num js-line-number" data-line-number="21"></td>
        <td id="file-docker_aliases-sh-LC21" class="blob-code blob-code-inner js-file-line">}</td>
      </tr>
      <tr>
        <td id="file-docker_aliases-sh-L22" class="blob-num js-line-number" data-line-number="22"></td>
        <td id="file-docker_aliases-sh-LC22" class="blob-code blob-code-inner js-file-line">
</td>
      </tr>
      <tr>
        <td id="file-docker_aliases-sh-L23" class="blob-num js-line-number" data-line-number="23"></td>
        <td id="file-docker_aliases-sh-LC23" class="blob-code blob-code-inner js-file-line"><span class="pl-en">impacket</span>() {</td>
      </tr>
      <tr>
        <td id="file-docker_aliases-sh-L24" class="blob-num js-line-number" data-line-number="24"></td>
        <td id="file-docker_aliases-sh-LC24" class="blob-code blob-code-inner js-file-line">    docker run --rm -it rflathers/impacket <span class="pl-s"><span class="pl-pds">"</span><span class="pl-smi">$@</span><span class="pl-pds">"</span></span></td>
      </tr>
      <tr>
        <td id="file-docker_aliases-sh-L25" class="blob-num js-line-number" data-line-number="25"></td>
        <td id="file-docker_aliases-sh-LC25" class="blob-code blob-code-inner js-file-line">}</td>
      </tr>
      <tr>
        <td id="file-docker_aliases-sh-L26" class="blob-num js-line-number" data-line-number="26"></td>
        <td id="file-docker_aliases-sh-LC26" class="blob-code blob-code-inner js-file-line">
</td>
      </tr>
      <tr>
        <td id="file-docker_aliases-sh-L27" class="blob-num js-line-number" data-line-number="27"></td>
        <td id="file-docker_aliases-sh-LC27" class="blob-code blob-code-inner js-file-line"><span class="pl-en">smbservehere</span>() {</td>
      </tr>
      <tr>
        <td id="file-docker_aliases-sh-L28" class="blob-num js-line-number" data-line-number="28"></td>
        <td id="file-docker_aliases-sh-LC28" class="blob-code blob-code-inner js-file-line">    <span class="pl-k">local</span> sharename</td>
      </tr>
      <tr>
        <td id="file-docker_aliases-sh-L29" class="blob-num js-line-number" data-line-number="29"></td>
        <td id="file-docker_aliases-sh-LC29" class="blob-code blob-code-inner js-file-line">    [[ <span class="pl-k">-z</span> <span class="pl-smi">$1</span> ]] <span class="pl-k">&amp;&amp;</span> sharename=<span class="pl-s"><span class="pl-pds">"</span>SHARE<span class="pl-pds">"</span></span> <span class="pl-k">||</span> sharename=<span class="pl-smi">$1</span></td>
      </tr>
      <tr>
        <td id="file-docker_aliases-sh-L30" class="blob-num js-line-number" data-line-number="30"></td>
        <td id="file-docker_aliases-sh-LC30" class="blob-code blob-code-inner js-file-line">    docker run --rm -it -p 445:445 -v <span class="pl-s"><span class="pl-pds">"</span><span class="pl-smi">${PWD}</span>:/tmp/serve<span class="pl-pds">"</span></span> rflathers/impacket smbserver.py -smb2support <span class="pl-smi">$sharename</span> /tmp/serve</td>
      </tr>
      <tr>
        <td id="file-docker_aliases-sh-L31" class="blob-num js-line-number" data-line-number="31"></td>
        <td id="file-docker_aliases-sh-LC31" class="blob-code blob-code-inner js-file-line">}</td>
      </tr>
      <tr>
        <td id="file-docker_aliases-sh-L32" class="blob-num js-line-number" data-line-number="32"></td>
        <td id="file-docker_aliases-sh-LC32" class="blob-code blob-code-inner js-file-line">
</td>
      </tr>
      <tr>
        <td id="file-docker_aliases-sh-L33" class="blob-num js-line-number" data-line-number="33"></td>
        <td id="file-docker_aliases-sh-LC33" class="blob-code blob-code-inner js-file-line"><span class="pl-en">nginxhere</span>() {</td>
      </tr>
      <tr>
        <td id="file-docker_aliases-sh-L34" class="blob-num js-line-number" data-line-number="34"></td>
        <td id="file-docker_aliases-sh-LC34" class="blob-code blob-code-inner js-file-line">    docker run --rm -it -p 80:80 -p 443:443 -v <span class="pl-s"><span class="pl-pds">"</span><span class="pl-smi">${PWD}</span>:/srv/data<span class="pl-pds">"</span></span> rflathers/nginxserve</td>
      </tr>
      <tr>
        <td id="file-docker_aliases-sh-L35" class="blob-num js-line-number" data-line-number="35"></td>
        <td id="file-docker_aliases-sh-LC35" class="blob-code blob-code-inner js-file-line">}</td>
      </tr>
      <tr>
        <td id="file-docker_aliases-sh-L36" class="blob-num js-line-number" data-line-number="36"></td>
        <td id="file-docker_aliases-sh-LC36" class="blob-code blob-code-inner js-file-line">
</td>
      </tr>
      <tr>
        <td id="file-docker_aliases-sh-L37" class="blob-num js-line-number" data-line-number="37"></td>
        <td id="file-docker_aliases-sh-LC37" class="blob-code blob-code-inner js-file-line"><span class="pl-en">webdavhere</span>() {</td>
      </tr>
      <tr>
        <td id="file-docker_aliases-sh-L38" class="blob-num js-line-number" data-line-number="38"></td>
        <td id="file-docker_aliases-sh-LC38" class="blob-code blob-code-inner js-file-line">    docker run --rm -it -p 80:80 -v <span class="pl-s"><span class="pl-pds">"</span><span class="pl-smi">${PWD}</span>:/srv/data/share<span class="pl-pds">"</span></span> rflathers/webdav</td>
      </tr>
      <tr>
        <td id="file-docker_aliases-sh-L39" class="blob-num js-line-number" data-line-number="39"></td>
        <td id="file-docker_aliases-sh-LC39" class="blob-code blob-code-inner js-file-line">}</td>
      </tr>
      <tr>
        <td id="file-docker_aliases-sh-L40" class="blob-num js-line-number" data-line-number="40"></td>
        <td id="file-docker_aliases-sh-LC40" class="blob-code blob-code-inner js-file-line">
</td>
      </tr>
      <tr>
        <td id="file-docker_aliases-sh-L41" class="blob-num js-line-number" data-line-number="41"></td>
        <td id="file-docker_aliases-sh-LC41" class="blob-code blob-code-inner js-file-line"><span class="pl-en">metasploit</span>() {</td>
      </tr>
      <tr>
        <td id="file-docker_aliases-sh-L42" class="blob-num js-line-number" data-line-number="42"></td>
        <td id="file-docker_aliases-sh-LC42" class="blob-code blob-code-inner js-file-line">    docker run --rm -it -v <span class="pl-s"><span class="pl-pds">"</span><span class="pl-smi">${HOME}</span>/.msf4:/home/msf/.msf4<span class="pl-pds">"</span></span> metasploitframework/metasploit-framework ./msfconsole <span class="pl-s"><span class="pl-pds">"</span><span class="pl-smi">$@</span><span class="pl-pds">"</span></span></td>
      </tr>
      <tr>
        <td id="file-docker_aliases-sh-L43" class="blob-num js-line-number" data-line-number="43"></td>
        <td id="file-docker_aliases-sh-LC43" class="blob-code blob-code-inner js-file-line">}</td>
      </tr>
      <tr>
        <td id="file-docker_aliases-sh-L44" class="blob-num js-line-number" data-line-number="44"></td>
        <td id="file-docker_aliases-sh-LC44" class="blob-code blob-code-inner js-file-line">
</td>
      </tr>
      <tr>
        <td id="file-docker_aliases-sh-L45" class="blob-num js-line-number" data-line-number="45"></td>
        <td id="file-docker_aliases-sh-LC45" class="blob-code blob-code-inner js-file-line"><span class="pl-en">metasploitports</span>() {</td>
      </tr>
      <tr>
        <td id="file-docker_aliases-sh-L46" class="blob-num js-line-number" data-line-number="46"></td>
        <td id="file-docker_aliases-sh-LC46" class="blob-code blob-code-inner js-file-line">    docker run --rm -it -v <span class="pl-s"><span class="pl-pds">"</span><span class="pl-smi">${HOME}</span>/.msf4:/home/msf/.msf4<span class="pl-pds">"</span></span> -p 8443-8500:8443-8500 metasploitframework/metasploit-framework ./msfconsole <span class="pl-s"><span class="pl-pds">"</span><span class="pl-smi">$@</span><span class="pl-pds">"</span></span></td>
      </tr>
      <tr>
        <td id="file-docker_aliases-sh-L47" class="blob-num js-line-number" data-line-number="47"></td>
        <td id="file-docker_aliases-sh-LC47" class="blob-code blob-code-inner js-file-line">}</td>
      </tr>
      <tr>
        <td id="file-docker_aliases-sh-L48" class="blob-num js-line-number" data-line-number="48"></td>
        <td id="file-docker_aliases-sh-LC48" class="blob-code blob-code-inner js-file-line">
</td>
      </tr>
      <tr>
        <td id="file-docker_aliases-sh-L49" class="blob-num js-line-number" data-line-number="49"></td>
        <td id="file-docker_aliases-sh-LC49" class="blob-code blob-code-inner js-file-line"><span class="pl-en">msfvenomhere</span>() {</td>
      </tr>
      <tr>
        <td id="file-docker_aliases-sh-L50" class="blob-num js-line-number" data-line-number="50"></td>
        <td id="file-docker_aliases-sh-LC50" class="blob-code blob-code-inner js-file-line">    docker run --rm -it -v <span class="pl-s"><span class="pl-pds">"</span><span class="pl-smi">${HOME}</span>/.msf4:/home/msf/.msf4<span class="pl-pds">"</span></span> -v <span class="pl-s"><span class="pl-pds">"</span><span class="pl-smi">${PWD}</span>:/data<span class="pl-pds">"</span></span> metasploitframework/metasploit-framework ./msfvenom <span class="pl-s"><span class="pl-pds">"</span><span class="pl-smi">$@</span><span class="pl-pds">"</span></span></td>
      </tr>
      <tr>
        <td id="file-docker_aliases-sh-L51" class="blob-num js-line-number" data-line-number="51"></td>
        <td id="file-docker_aliases-sh-LC51" class="blob-code blob-code-inner js-file-line">}</td>
      </tr>
      <tr>
        <td id="file-docker_aliases-sh-L52" class="blob-num js-line-number" data-line-number="52"></td>
        <td id="file-docker_aliases-sh-LC52" class="blob-code blob-code-inner js-file-line">
</td>
      </tr>
      <tr>
        <td id="file-docker_aliases-sh-L53" class="blob-num js-line-number" data-line-number="53"></td>
        <td id="file-docker_aliases-sh-LC53" class="blob-code blob-code-inner js-file-line"><span class="pl-en">reqdump</span>() {</td>
      </tr>
      <tr>
        <td id="file-docker_aliases-sh-L54" class="blob-num js-line-number" data-line-number="54"></td>
        <td id="file-docker_aliases-sh-LC54" class="blob-code blob-code-inner js-file-line">    docker run --rm -it -p 80:3000 rflathers/reqdump</td>
      </tr>
      <tr>
        <td id="file-docker_aliases-sh-L55" class="blob-num js-line-number" data-line-number="55"></td>
        <td id="file-docker_aliases-sh-LC55" class="blob-code blob-code-inner js-file-line">}</td>
      </tr>
      <tr>
        <td id="file-docker_aliases-sh-L56" class="blob-num js-line-number" data-line-number="56"></td>
        <td id="file-docker_aliases-sh-LC56" class="blob-code blob-code-inner js-file-line">
</td>
      </tr>
      <tr>
        <td id="file-docker_aliases-sh-L57" class="blob-num js-line-number" data-line-number="57"></td>
        <td id="file-docker_aliases-sh-LC57" class="blob-code blob-code-inner js-file-line"><span class="pl-en">postfiledumphere</span>() {</td>
      </tr>
      <tr>
        <td id="file-docker_aliases-sh-L58" class="blob-num js-line-number" data-line-number="58"></td>
        <td id="file-docker_aliases-sh-LC58" class="blob-code blob-code-inner js-file-line">    docker run --rm -it -p80:3000 -v <span class="pl-s"><span class="pl-pds">"</span><span class="pl-smi">${PWD}</span>:/data<span class="pl-pds">"</span></span> rflathers/postfiledump</td>
      </tr>
      <tr>
        <td id="file-docker_aliases-sh-L59" class="blob-num js-line-number" data-line-number="59"></td>
        <td id="file-docker_aliases-sh-LC59" class="blob-code blob-code-inner js-file-line">}</td>
      </tr>
</tbody></table>


  </div>

  </div>
</div>

      </div>
      <div class="gist-meta">
        <a href="https://gist.github.com/ropnop/c21c35e67a07da2ab50dbb8a085ccd22/raw/982662daa2517d6adf88ce0381845411573bbb64/docker_aliases.sh" style="float:right">view raw</a>
        <a href="https://gist.github.com/ropnop/c21c35e67a07da2ab50dbb8a085ccd22#file-docker_aliases-sh">docker_aliases.sh</a>
        hosted with ❤ by <a href="https://github.com/">GitHub</a>
      </div>
    </div>
</div>

</section>
<section class="social-share">
<ul class="rrssb-buttons clearfix rrssb-2 large-format" style="font-size: 19.4167px;">
<li class="rrssb-email" style="width: 33.3333%;" data-initwidth="33.333333333333336" data-size="38">

<a href="mailto:?subject=Docker%20for%20Pentesters&amp;body=Docker%20for%20Pentesters%0A%0Ahttps%3A%2F%2Fblog.ropnop.com%2Fdocker-for-pentesters%2F">
<span class="rrssb-icon">
<svg xmlns="http://www.w3.org/2000/svg" width="28" height="28" viewBox="0 0 28 28">
<path d="M20.11 26.147c-2.335 1.05-4.36 1.4-7.124 1.4C6.524 27.548.84 22.916.84 15.284.84 7.343 6.602.45 15.4.45c6.854 0 11.8 4.7 11.8 11.252 0 5.684-3.193 9.265-7.398 9.3-1.83 0-3.153-.934-3.347-2.997h-.077c-1.208 1.986-2.96 2.997-5.023 2.997-2.532 0-4.36-1.868-4.36-5.062 0-4.75 3.503-9.07 9.11-9.07 1.713 0 3.7.4 4.6.972l-1.17 7.203c-.387 2.298-.115 3.3 1 3.4 1.674 0 3.774-2.102 3.774-6.58 0-5.06-3.27-8.994-9.304-8.994C9.05 2.87 3.83 7.545 3.83 14.97c0 6.5 4.2 10.2 10 10.202 1.987 0 4.09-.43 5.647-1.245l.634 2.22zM16.647 10.1c-.31-.078-.7-.155-1.207-.155-2.572 0-4.596 2.53-4.596 5.53 0 1.5.7 2.4 1.9 2.4 1.44 0 2.96-1.83 3.31-4.088l.592-3.72z"></path>
</svg>
</span>
<span class="rrssb-text">email</span>
</a>
</li>
<li class="rrssb-twitter" style="width: 33.3333%;" data-initwidth="33.333333333333336" data-size="55">

<a href="https://twitter.com/intent/tweet?text=Docker%20for%20Pentesters%20https%3A%2F%2Fblog.ropnop.com%2Fdocker-for-pentesters%2F" class="popup">
<span class="rrssb-icon">
<svg xmlns="http://www.w3.org/2000/svg" width="28" height="28" viewBox="0 0 28 28">
<path d="M24.253 8.756C24.69 17.08 18.297 24.182 9.97 24.62c-3.122.162-6.22-.646-8.86-2.32 2.702.18 5.375-.648 7.507-2.32-2.072-.248-3.818-1.662-4.49-3.64.802.13 1.62.077 2.4-.154-2.482-.466-4.312-2.586-4.412-5.11.688.276 1.426.408 2.168.387-2.135-1.65-2.73-4.62-1.394-6.965C5.574 7.816 9.54 9.84 13.802 10.07c-.842-2.738.694-5.64 3.434-6.48 2.018-.624 4.212.043 5.546 1.682 1.186-.213 2.318-.662 3.33-1.317-.386 1.256-1.248 2.312-2.4 2.942 1.048-.106 2.07-.394 3.02-.85-.458 1.182-1.343 2.15-2.48 2.71z"></path>
</svg>
</span>
<span class="rrssb-text">twitter</span>
</a>
</li>
<li class="rrssb-reddit" style="width: 33.3333%;" data-initwidth="33.333333333333336" data-size="46">
<a href="http://www.reddit.com/submit?url=https%3A%2F%2Fblog.ropnop.com%2Fdocker-for-pentesters%2F&amp;text=Docker%20for%20Pentesters&amp;title=Docker%20for%20Pentesters">
<span class="rrssb-icon">
<svg xmlns="http://www.w3.org/2000/svg" width="28" height="28" viewBox="0 0 28 28">
<path d="M11.794 15.316c0-1.03-.835-1.895-1.866-1.895-1.03 0-1.893.866-1.893 1.896s.863 1.9 1.9 1.9c1.023-.016 1.865-.916 1.865-1.9zM18.1 13.422c-1.03 0-1.895.864-1.895 1.895 0 1 .9 1.9 1.9 1.865 1.03 0 1.87-.836 1.87-1.865-.006-1.017-.875-1.917-1.875-1.895zM17.527 19.79c-.678.68-1.826 1.007-3.514 1.007h-.03c-1.686 0-2.834-.328-3.51-1.005-.264-.265-.693-.265-.958 0-.264.265-.264.7 0 1 .943.9 2.4 1.4 4.5 1.402.005 0 0 0 0 0 .005 0 0 0 0 0 2.066 0 3.527-.46 4.47-1.402.265-.264.265-.693.002-.958-.267-.334-.688-.334-.988-.043z"></path>
<path d="M27.707 13.267c0-1.785-1.453-3.237-3.236-3.237-.792 0-1.517.287-2.08.76-2.04-1.294-4.647-2.068-7.44-2.218l1.484-4.69 4.062.955c.07 1.4 1.3 2.6 2.7 2.555 1.488 0 2.695-1.208 2.695-2.695C25.88 3.2 24.7 2 23.2 2c-1.06 0-1.98.616-2.42 1.508l-4.633-1.09c-.344-.082-.693.117-.803.454l-1.793 5.7C10.55 8.6 7.7 9.4 5.6 10.75c-.594-.45-1.3-.75-2.1-.72-1.785 0-3.237 1.45-3.237 3.2 0 1.1.6 2.1 1.4 2.69-.04.27-.06.55-.06.83 0 2.3 1.3 4.4 3.7 5.9 2.298 1.5 5.3 2.3 8.6 2.325 3.227 0 6.27-.825 8.57-2.325 2.387-1.56 3.7-3.66 3.7-5.917 0-.26-.016-.514-.05-.768.965-.465 1.577-1.565 1.577-2.698zm-4.52-9.912c.74 0 1.3.6 1.3 1.3 0 .738-.6 1.34-1.34 1.34s-1.343-.602-1.343-1.34c.04-.655.596-1.255 1.396-1.3zM1.646 13.3c0-1.038.845-1.882 1.883-1.882.31 0 .6.1.9.21-1.05.867-1.813 1.86-2.26 2.9-.338-.328-.57-.728-.57-1.26zm20.126 8.27c-2.082 1.357-4.863 2.105-7.83 2.105-2.968 0-5.748-.748-7.83-2.105-1.99-1.3-3.087-3-3.087-4.782 0-1.784 1.097-3.484 3.088-4.784 2.08-1.358 4.86-2.106 7.828-2.106 2.967 0 5.7.7 7.8 2.106 1.99 1.3 3.1 3 3.1 4.784C24.86 18.6 23.8 20.3 21.8 21.57zm4.014-6.97c-.432-1.084-1.19-2.095-2.244-2.977.273-.156.59-.245.928-.245 1.036 0 1.9.8 1.9 1.9-.016.522-.27 1.022-.57 1.327z"></path>
</svg>
</span>
<span class="rrssb-text">reddit</span>
</a>
</li>
</ul>
</section>
<footer class="post-footer">
<section class="author">
<h4><a href="https://blog.ropnop.com/author/ropnop/">ropnop</a></h4>
<p>Read <a href="https://blog.ropnop.com/author/ropnop/">more posts</a> by this author.</p>
<div class="author-meta">
</div>
</section>
<section class="post-comments">
<div id="disqus_thread"><iframe id="dsq-app8134" name="dsq-app8134" allowtransparency="true" scrolling="no" tabindex="0" title="Disqus" sandbox="allow-forms allow-popups allow-same-origin allow-scripts" style="width: 1px !important; min-width: 100% !important; border: medium none !important; overflow: hidden !important; height: 0px !important; display: none !important;" src="//tempest.services.disqus.com/ads-iframe/google/?category=tech&amp;display_bidding_enabled=0&amp;stories_allowed=1&amp;service=dynamic&amp;position=top&amp;display_allowed=1&amp;video_allowed=1&amp;provider=google&amp;thumbnails_allowed=1&amp;experiment=polymorph_replacement&amp;variant=google&amp;display_only=0&amp;sandbox_display=1&amp;links_allowed=1&amp;doublewide_allowed=1&amp;shortname=ropnopblog&amp;forum_pk=4177700&amp;forum_shortname=ropnopblog&amp;safetylevel=30&amp;t=1563522788&amp;anchorColor=%234a4a4a&amp;colorScheme=light&amp;sourceUrl=https%3A%2F%2Fblog.ropnop.com%2Fdocker-for-pentesters%2F&amp;typeface=serif&amp;canonicalUrl=https%3A%2F%2Fblog.ropnop.com%2Fdocker-for-pentesters%2F&amp;disqus_version=3396363" width="100%" frameborder="0"></iframe><iframe id="dsq-app8131" name="dsq-app8131" allowtransparency="true" scrolling="no" tabindex="0" title="Disqus" style="width: 1px !important; min-width: 100% !important; border: medium none !important; overflow: hidden !important; height: 390px !important;" src="Docker%20for%20Pentesters_files/a_002.html" horizontalscrolling="no" verticalscrolling="no" width="100%" frameborder="0"></iframe><iframe id="indicator-north" name="indicator-north" allowtransparency="true" scrolling="no" tabindex="0" title="Disqus" style="width: 710px !important; border: medium none !important; overflow: hidden !important; top: 0px !important; min-width: 710px !important; max-width: 710px !important; position: fixed !important; z-index: 2147483646 !important; height: 19px !important; min-height: 19px !important; max-height: 19px !important; display: none !important;" frameborder="0"></iframe><iframe id="indicator-south" name="indicator-south" allowtransparency="true" scrolling="no" tabindex="0" title="Disqus" style="width: 710px !important; border: medium none !important; overflow: hidden !important; bottom: 0px !important; min-width: 710px !important; max-width: 710px !important; position: fixed !important; z-index: 2147483646 !important; height: 19px !important; min-height: 19px !important; max-height: 19px !important; display: none !important;" frameborder="0"></iframe></div>
<script type="text/javascript">
              // required: replace example with your forum shortname
              if(disqus_shortname && typeof disqus_shortname === "string") {
                  var disqus_identifier = '';

                  /* * * DON'T EDIT BELOW THIS LINE * * */
                  (function() {
                  var dsq = document.createElement('script'); dsq.type = 'text/javascript'; dsq.async = true;
                  dsq.src = '//' + disqus_shortname + '.disqus.com/embed.js';
                  (document.getElementsByTagName('head')[0] || document.getElementsByTagName('body')[0]).appendChild(dsq);
                  })();
              }
              </script>
<noscript>Please enable JavaScript to view the <a href="http://disqus.com/?ref_noscript">comments powered by Disqus.</a></noscript>
</section>
</footer>
</article>
</main>
<aside class="read-next">
<a class="read-next-story prev no-cover" href="https://blog.ropnop.com/attacking-default-installs-of-helm-on-kubernetes/">
<section class="post">
<h2>Attacking default installs of Helm on Kubernetes</h2>
<p>Intro I have totally fallen down the Kubernetes rabbit hole and am really enjoying playing with it and attacking…</p>
</section>
</a>
</aside>
<footer class="site-footer clearfix">
<section class="copyright"><a href="https://blog.ropnop.com/">ropnop blog</a> © 2019</section>
<section class="poweredby">Proudly published with <a href="https://ghost.org/">Ghost</a></section>
</footer>
</div>
<script type="text/javascript" src="Docker%20for%20Pentesters_files/jquery-1.js"></script>
<script type="text/javascript" src="Docker%20for%20Pentesters_files/jquery.js"></script>
<script type="text/javascript" src="Docker%20for%20Pentesters_files/index.js"></script>
<script type="text/javascript" src="Docker%20for%20Pentesters_files/prism.js"></script>
<script type="text/javascript" src="Docker%20for%20Pentesters_files/rrssb.js"></script>
<script src="Docker%20for%20Pentesters_files/lightbox.js"></script>
<link href="Docker%20for%20Pentesters_files/lightbox.css" rel="stylesheet">
<script type="text/javascript">
        jQuery(document).ready(function($) {

            $('.rrssb-buttons').rrssb({
                // required:
                title: 'Docker for Pentesters',
                url: 'https://blog.ropnop.com/docker-for-pentesters/',

                // optional:
                 description: 'Docker for Pentesters',
                // emailBody: 'Usually email body is just the description + url, but you can customize it if you want'
            });

        });
    </script>
<script>
        // TO ACTIVATE ADD var ga_id = "your_ga_id" to ghost code injection header
        if (window.ga_id) {
            (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
            (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
            m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
            })(window,document,'script','//www.google-analytics.com/analytics.js','ga');
            ga('create', window.ga_id, 'auto');
            ga('require', 'linkid', 'linkid.js');
            ga('send', 'pageview');
        }
    </script>
<script>
        if(window.social_link){
            var url_regexp = /^(https?:\/\/)?([\da-z\.-]+)\.([a-z\.]{2,6})([\/\w \.-]*)*\/?$/
            $.each(window.social_link,function(type, url){
                if(typeof url ==="string" && url_regexp.test(url)){
                    $('<li>').append($('<a>',{
                                        html: '<i class="fa fa-'+type+'"></i>',
                                        title: type,
                                        href: url,
                                        target: "_blank"
                                    })
                                ).appendTo('.social_link');

                }
            })
        }
    </script>


<div id="lightboxOverlay" class="lightboxOverlay" style="display: none;"></div><div id="lightbox" class="lightbox" style="display: none;"><div class="lb-outerContainer"><div class="lb-container"><img class="lb-image" src="data:image/gif;base64,R0lGODlhAQABAIAAAP///wAAACH5BAEAAAAALAAAAAABAAEAAAICRAEAOw=="><div class="lb-nav"><a class="lb-prev" href=""></a><a class="lb-next" href=""></a></div><div class="lb-loader"><a class="lb-cancel"></a></div></div></div><div class="lb-dataContainer"><div class="lb-data"><div class="lb-details"><span class="lb-caption"></span><span class="lb-number"></span></div><div class="lb-closeContainer"><a class="lb-close"></a></div></div></div></div><iframe style="display: none;"></iframe><style>.adsbox
{display:none !important;}</style><style>iframe[src="//tempest.services.disqus.com/ads-iframe/google/?category=tech&display_bidding_enabled=0&stories_allowed=1&service=dynamic&position=top&display_allowed=1&video_allowed=1&provider=google&thumbnails_allowed=1&experiment=polymorph_replacement&variant=google&display_only=0&sandbox_display=1&links_allowed=1&doublewide_allowed=1&shortname=ropnopblog&forum_pk=4177700&forum_shortname=ropnopblog&safetylevel=30&t=1563522788&anchorColor=%234a4a4a&colorScheme=light&sourceUrl=https%3A%2F%2Fblog.ropnop.com%2Fdocker-for-pentesters%2F&typeface=serif&canonicalUrl=https%3A%2F%2Fblog.ropnop.com%2Fdocker-for-pentesters%2F&disqus_version=3396363"]
{display:none !important;}</style></body></html>